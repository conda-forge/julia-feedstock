From a3d1db759fbe063f30e0d9161b5aadcd745e37ac Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Mos=C3=A8=20Giordano?= <mose@gnu.org>
Date: Mon, 18 Dec 2023 22:07:09 +0100
Subject: [PATCH 1/3] [SuiteSparse_jll] Upgrade to v7.4.0

---
 Makefile                                      |  2 +-
 base/Makefile                                 |  2 -
 deps/checksums/suitesparse                    | 66 +++++++++----------
 deps/libsuitesparse.version                   |  6 +-
 stdlib/SuiteSparse_jll/Project.toml           |  4 +-
 stdlib/SuiteSparse_jll/src/SuiteSparse_jll.jl |  4 +-
 6 files changed, 41 insertions(+), 43 deletions(-)

diff --git a/Makefile b/Makefile
index 056436af89fe3..89fe35b470094 100644
--- a/Makefile
+++ b/Makefile
@@ -203,7 +203,7 @@ else ifeq ($(JULIA_BUILD_MODE),debug)
 JL_PRIVATE_LIBS-0 += libjulia-internal-debug libjulia-codegen-debug
 endif
 ifeq ($(USE_GPL_LIBS), 1)
-JL_PRIVATE_LIBS-$(USE_SYSTEM_LIBSUITESPARSE) += libamd libbtf libcamd libccolamd libcholmod libcholmod_cuda libcolamd libklu libldl librbio libspqr libspqr_cuda libsuitesparseconfig libumfpack
+JL_PRIVATE_LIBS-$(USE_SYSTEM_LIBSUITESPARSE) += libamd libbtf libcamd libccolamd libcholmod libcolamd libklu libldl librbio libspqr libsuitesparseconfig libumfpack
 endif
 JL_PRIVATE_LIBS-$(USE_SYSTEM_LIBBLASTRAMPOLINE) += libblastrampoline
 JL_PRIVATE_LIBS-$(USE_SYSTEM_PCRE) += libpcre2-8
diff --git a/base/Makefile b/base/Makefile
index ad2bb6a63ccc0..493302af78b02 100644
--- a/base/Makefile
+++ b/base/Makefile
@@ -269,11 +269,9 @@ $(eval $(call symlink_system_library,LIBSUITESPARSE,libamd))
 $(eval $(call symlink_system_library,LIBSUITESPARSE,libcamd))
 $(eval $(call symlink_system_library,LIBSUITESPARSE,libccolamd))
 $(eval $(call symlink_system_library,LIBSUITESPARSE,libcholmod))
-$(eval $(call symlink_system_library,LIBSUITESPARSE,libcholmod_cuda))
 $(eval $(call symlink_system_library,LIBSUITESPARSE,libcolamd))
 $(eval $(call symlink_system_library,LIBSUITESPARSE,libumfpack))
 $(eval $(call symlink_system_library,LIBSUITESPARSE,libspqr))
-$(eval $(call symlink_system_library,LIBSUITESPARSE,libspqr_cuda))
 $(eval $(call symlink_system_library,LIBSUITESPARSE,libsuitesparseconfig))
 # EXCLUDED LIBRARIES (installed/used, but not vendored for use with dlopen):
 # libunwind
diff --git a/deps/checksums/suitesparse b/deps/checksums/suitesparse
index 7578826fe3f0e..c55c22b37ab55 100644
--- a/deps/checksums/suitesparse
+++ b/deps/checksums/suitesparse
@@ -1,34 +1,32 @@
-SuiteSparse-7.2.1.tar.gz/md5/c341b4b2943b6d99ec147dc36ae64d51
-SuiteSparse-7.2.1.tar.gz/sha512/6385b699d2f109e8473bb58e95705671b8a5c2f1b281d17bba9f396a94b2e783700c4c64f4ab9495a4a64e23ba279052616054045783b4b8c8eb28a8f4f6be28
-SuiteSparse.v7.2.1+1.aarch64-apple-darwin.tar.gz/md5/1bd9c850b5bb6de56f4dfd0633ce7a6c
-SuiteSparse.v7.2.1+1.aarch64-apple-darwin.tar.gz/sha512/f0e932fa2b6d2843fd75c1e151b8304ed2521b679c732301877495d9a2437ec693ba0ebaaf52cb3a4f5c01bcd8c972a27b1080071c9c77462901fa4dec7de787
-SuiteSparse.v7.2.1+1.aarch64-linux-gnu.tar.gz/md5/ff52a5ef6546bbea2ce2d73db2821522
-SuiteSparse.v7.2.1+1.aarch64-linux-gnu.tar.gz/sha512/f5c2a54e40b36fc0489140397e6324bbd1050a87949fd9be3837012825c3becbef66258d28c286d0c45b0447361b2ddf736370402ed928b909e0fb7c5f4ee69c
-SuiteSparse.v7.2.1+1.aarch64-linux-musl.tar.gz/md5/2baa4103f4070f66d6278fc001317372
-SuiteSparse.v7.2.1+1.aarch64-linux-musl.tar.gz/sha512/17bc9b020850d9cc652d49987c3faa57204ed3beecd04ea812fd03b4f60f541ba7b250fa70c801a8ec3c440f3562a4771a3742299f0d4eb770e58010c43a3823
-SuiteSparse.v7.2.1+1.armv6l-linux-gnueabihf.tar.gz/md5/cdc1c60e50f6551a52e57ac71440564a
-SuiteSparse.v7.2.1+1.armv6l-linux-gnueabihf.tar.gz/sha512/9209f86ac97c061755169412565055847be4890140a389a92468297507cee240219d910bbcef94c52926771a4152762cfa05cfa33c26d31351d68265e5719bd3
-SuiteSparse.v7.2.1+1.armv6l-linux-musleabihf.tar.gz/md5/cd5e177e660d793426e4c4aeb2f9269c
-SuiteSparse.v7.2.1+1.armv6l-linux-musleabihf.tar.gz/sha512/a8a5ca739999a16336b2c98ec88873e00349720b5d966d643d5665338b1f9c8077352d87fac41a165cb65793ae5fb686e954b3eaa3f751aa8d002388a0ce6a13
-SuiteSparse.v7.2.1+1.armv7l-linux-gnueabihf.tar.gz/md5/eb43136009b370e93c6ab4c1b0eec40c
-SuiteSparse.v7.2.1+1.armv7l-linux-gnueabihf.tar.gz/sha512/e20a308911a36037c9b6da3c060f8624b1ff84b0e23cbd62189f62e989f6a5307b07a6286d95459e0886a8d16fd59ad5a34607dd2c644f7bedc786dd6567670c
-SuiteSparse.v7.2.1+1.armv7l-linux-musleabihf.tar.gz/md5/19f9246fc6c8bd2c7a4d2df498725abe
-SuiteSparse.v7.2.1+1.armv7l-linux-musleabihf.tar.gz/sha512/d2cba310fe33ddb11d9ada37ce04905dfc3f058a1cbf7b53ca1dc31c2c51bcf930a4976c39d55bfdacb19195ff772acb1c6876238640a6ed6277777934a8b53f
-SuiteSparse.v7.2.1+1.i686-linux-gnu.tar.gz/md5/8ff91e530528c8761411b8d9be56d1f0
-SuiteSparse.v7.2.1+1.i686-linux-gnu.tar.gz/sha512/42bd937fb1c476164b923b5093d3df3fc3cdd4e3bc148616ba48027d4616479d674a4c8f7291cf7004a43834508b459630f4cafbd90850d10402d53faa34e714
-SuiteSparse.v7.2.1+1.i686-linux-musl.tar.gz/md5/49bc8f22a227748680734d89f64a4cf7
-SuiteSparse.v7.2.1+1.i686-linux-musl.tar.gz/sha512/b78b84d330a8f22e7d9fdd72fe621e9830c1afd908946d4101705f05546aa892b2f5ef87988dec39ccd81cbe4dbeb95adc277d096d60e106485c5b6f81cf4403
-SuiteSparse.v7.2.1+1.i686-w64-mingw32.tar.gz/md5/cd593a3c801ba72bf6d77788c7ca06b9
-SuiteSparse.v7.2.1+1.i686-w64-mingw32.tar.gz/sha512/0b49795ed5cb773a5930d305e65d53ff35ff1d1ee0a84e8762f56ca442c2421752b50b667646fd6a977c0684c2214996011f405ff1c7fd6eeaf16d08262d7d05
-SuiteSparse.v7.2.1+1.powerpc64le-linux-gnu.tar.gz/md5/3858c87b8f62844520ff61c72d7b5a25
-SuiteSparse.v7.2.1+1.powerpc64le-linux-gnu.tar.gz/sha512/ea505fe14155ee69a715339fe7075603c04458d5c7f65fecb92bea69a86117b1d21da75dab832ac0f6cc9aa64bfa6d7f50cb679fefa9ec5b4d4d8826d3137ff9
-SuiteSparse.v7.2.1+1.x86_64-apple-darwin.tar.gz/md5/241dec5338e04fbf6084cec90bbd2f76
-SuiteSparse.v7.2.1+1.x86_64-apple-darwin.tar.gz/sha512/8477d2102be709aa2f74325df91aab4f9c894c8f516cd17d3780aab66bcbf920fa5771fa7e130a63793f94b99c6cfc4db6ab22e6a33a55670e25e36472770d59
-SuiteSparse.v7.2.1+1.x86_64-linux-gnu.tar.gz/md5/c6b6fa99a21a9000892d51b821f304a7
-SuiteSparse.v7.2.1+1.x86_64-linux-gnu.tar.gz/sha512/ad2e1200d0418c531758672b64e849c81cfe74ca73cff0e1a47797e73dbc4675c9a2ec855af628dddef58b135412d06fa18c15565c94de5e1e6d15e3b150ecbd
-SuiteSparse.v7.2.1+1.x86_64-linux-musl.tar.gz/md5/6c14129471a9c92464d36ae00f4c5a08
-SuiteSparse.v7.2.1+1.x86_64-linux-musl.tar.gz/sha512/e9051ceb7d551019deb16480b493d1ac5b622fe86c7e19b1023eb12af28d42f25e911e1e44870c35849d8f95d78e8e28c38699cde1fab250dac32818ebc58a2b
-SuiteSparse.v7.2.1+1.x86_64-unknown-freebsd.tar.gz/md5/ab0f6a9b7789f21aba5ea10659b03ed3
-SuiteSparse.v7.2.1+1.x86_64-unknown-freebsd.tar.gz/sha512/cc9136bfda474914107e68f97a200d46f81a1f36ea51c4e482ef04e818d3ac10d14b2895eef59b2570f6115261e987bd076dd8f9be0e6d2dc77931d3257db142
-SuiteSparse.v7.2.1+1.x86_64-w64-mingw32.tar.gz/md5/e804d9ed593d739326865dc1f60d5800
-SuiteSparse.v7.2.1+1.x86_64-w64-mingw32.tar.gz/sha512/20c9ac62cd41b19e0b9605c8f9a8bece9089f7f69e2cf57ace3058215acefe8cf9ce39d3c05010223443bfc45b1efb8391be677a1b5e9a59bbdfe89f89553f71
+SuiteSparse.v7.4.0+2.aarch64-apple-darwin.tar.gz/md5/6f38a9c86969ad3fa2708c461bcd3b2b
+SuiteSparse.v7.4.0+2.aarch64-apple-darwin.tar.gz/sha512/fa15f40456a6bda38f76caa4aedebe30c3bb3e8cf240c0eb2740169d0e7bf2563d6d1ca84233beec99f222852a49d3394b545c7349eb9573bda9bc60d20e348b
+SuiteSparse.v7.4.0+2.aarch64-linux-gnu.tar.gz/md5/8cac9d510a4c3c6e6a9b0f69fe1e0270
+SuiteSparse.v7.4.0+2.aarch64-linux-gnu.tar.gz/sha512/5590ae9e295bf34de4c19fe166aa6f79579ba74e5ccd9dbc0fc7cd3ae83329dc98c9a97eb80e92bcee04da1ae08697c687ef227d10034927c007f3a6072c0068
+SuiteSparse.v7.4.0+2.aarch64-linux-musl.tar.gz/md5/a74d064ab69db273f81a340f1096bfb7
+SuiteSparse.v7.4.0+2.aarch64-linux-musl.tar.gz/sha512/5d3b113560cb2c92c40a65edfb2f248fcc83d446eee4c8d03dbdbfecebe52b26afc662996d01d023880cd701386c293871331fc5cbf5901a1f97e5b99c68f291
+SuiteSparse.v7.4.0+2.armv6l-linux-gnueabihf.tar.gz/md5/8188603ec5c7fa4c2b2f14d11f856ffa
+SuiteSparse.v7.4.0+2.armv6l-linux-gnueabihf.tar.gz/sha512/0b5dfdce559e526c17700e2158eed8697a9bcb6d6cf95d5b1685b40da0c5668c9ee2ad49ad3e483cfbb174386907b1b74beff2723397556908898fb3b7fa9135
+SuiteSparse.v7.4.0+2.armv6l-linux-musleabihf.tar.gz/md5/76e751060e520db03f2139d9bf4e4eb1
+SuiteSparse.v7.4.0+2.armv6l-linux-musleabihf.tar.gz/sha512/f43991680d401f69dde2aab623615d3ed49435ff6591fc8a9352c98fe1d83cc4dc5ad3709afbb6dd712db0c177da0db9fb8b0cdf999a7812516e23735b0d68b4
+SuiteSparse.v7.4.0+2.armv7l-linux-gnueabihf.tar.gz/md5/277be7e8b7b6c03c0b932a98cf50e5f1
+SuiteSparse.v7.4.0+2.armv7l-linux-gnueabihf.tar.gz/sha512/fa813d4c554b6c6f4c383317ac6e2966a8cd34e8039212eb28d90da4595390cfbaecf920a843a14c50d1b6ffc9b35d0b4eb15521c887f1ec1ceae4a7a2b44e9f
+SuiteSparse.v7.4.0+2.armv7l-linux-musleabihf.tar.gz/md5/e4deba38ec452076d6a1e1ce092de2b6
+SuiteSparse.v7.4.0+2.armv7l-linux-musleabihf.tar.gz/sha512/2dc72a55be4893f4c778f686e3817c58259f81d68e76dc488f039f4e44bbb1de2133547526cb3c545d50a5a9b5646f07485e1bee8bfcfe9a42cc8b4583d15324
+SuiteSparse.v7.4.0+2.i686-linux-gnu.tar.gz/md5/f263960cd809722b1c4f6d15a72eb1ab
+SuiteSparse.v7.4.0+2.i686-linux-gnu.tar.gz/sha512/2c487b48041804273cd5ff5ca9ae90edda0fbe41c9095a9a9dfad19899e83e3f8aa9d601bdcf580cf3259d731af3936b6bceacadcda3f93e2c550bdd1cc4e684
+SuiteSparse.v7.4.0+2.i686-linux-musl.tar.gz/md5/e172f720f04edcf408792df2d3b89572
+SuiteSparse.v7.4.0+2.i686-linux-musl.tar.gz/sha512/d544f711ab88c3fc121d431f7313903ec102a474c54a2580706b73b3b0c5c0f1000fc7cc9658824abc5c912124a44ba56711257dd2ff9117a7fb57e1df4fd618
+SuiteSparse.v7.4.0+2.i686-w64-mingw32.tar.gz/md5/72870e8e03725c022f73e2f0e6f10c8b
+SuiteSparse.v7.4.0+2.i686-w64-mingw32.tar.gz/sha512/17a2b530cc0e3c9397a382ee8550f6bdc6d74b1f678cc27fa45d921e8a6ee72de2ba29e18d33f6950c3944b1c9b26f86def0c45bcb81864e10f57f27f75d55ab
+SuiteSparse.v7.4.0+2.powerpc64le-linux-gnu.tar.gz/md5/e43022f51daa1c98c45b3af3b4933dfe
+SuiteSparse.v7.4.0+2.powerpc64le-linux-gnu.tar.gz/sha512/7cd79f842a90187ff69085964a84fb6531360f4c9fdfdef6e5958f0823aa1c2a00815b4bc04406eca824294adfbe0bce2352d3fb51d0b155e8a559e99fc98f11
+SuiteSparse.v7.4.0+2.x86_64-apple-darwin.tar.gz/md5/be0a2768aa0b61e9f02ccc774a457d24
+SuiteSparse.v7.4.0+2.x86_64-apple-darwin.tar.gz/sha512/bc71f1b93bc9988e251116f46659b1c6eef8098c0bbd41b470102bd25264d1e6ae3e4f7dc452ba6673650f3b1c2d49ba312b67722e89444cd5e113892db4f09f
+SuiteSparse.v7.4.0+2.x86_64-linux-gnu.tar.gz/md5/45a30119c300e16176d06fecf8415931
+SuiteSparse.v7.4.0+2.x86_64-linux-gnu.tar.gz/sha512/16650e560f1ceb779ef2a45053bfbe41e1ecc7d21213a64ddee3e26ec77210ed97b89b0b84c92edf807c1159f329d7f374234286af4d4b9f81458b55ab54ae39
+SuiteSparse.v7.4.0+2.x86_64-linux-musl.tar.gz/md5/6a4dd22176697ec1f1586da6421c626a
+SuiteSparse.v7.4.0+2.x86_64-linux-musl.tar.gz/sha512/d223763e4c59a41a556f3dab11071672fa11f970f606a51eabb6a6b9e31fbd5a3dc35ffe891edfea0bdef8e70f0293c30831b2982c287b573cfcdaff7a050fd0
+SuiteSparse.v7.4.0+2.x86_64-unknown-freebsd.tar.gz/md5/c358b60fa7e8ba9ece545e6d7e41b343
+SuiteSparse.v7.4.0+2.x86_64-unknown-freebsd.tar.gz/sha512/2b93a8c10828eab5948a73b6b800fb321f715468a17142fabd9477543d0312d24fd567fb9fa96372304519ceda2830b259f1da30f943bc9cfa85047e640cf8f7
+SuiteSparse.v7.4.0+2.x86_64-w64-mingw32.tar.gz/md5/924a1a85d178617480178602a2fa2828
+SuiteSparse.v7.4.0+2.x86_64-w64-mingw32.tar.gz/sha512/9e753fffe9a50a3cfd520263b90194555d5f5c9f685b0aaa66ab513b3e0a5529d0efc701650955bf9cf659c930af5357c131591dbd2e02c9e7b4fa03f86a3548
diff --git a/deps/libsuitesparse.version b/deps/libsuitesparse.version
index eea10d4f2beb8..ca38a96fb0ed3 100644
--- a/deps/libsuitesparse.version
+++ b/deps/libsuitesparse.version
@@ -1,6 +1,8 @@
+# -*- makefile -*-
+
 ## jll artifact
 LIBSUITESPARSE_JLL_NAME := SuiteSparse
 
 ## source build
-LIBSUITESPARSE_VER := 7.2.1
-LIBSUITESPARSE_SHA1=d6c84f7416eaee0d23d61c6c49ad1b73235d2ea2
+LIBSUITESPARSE_VER := 7.4.0
+LIBSUITESPARSE_SHA1=df91d7be262e6b5cddf5dd23ff42dec1713e7947
diff --git a/stdlib/SuiteSparse_jll/Project.toml b/stdlib/SuiteSparse_jll/Project.toml
index 7518d64e80200..787162c090f20 100644
--- a/stdlib/SuiteSparse_jll/Project.toml
+++ b/stdlib/SuiteSparse_jll/Project.toml
@@ -1,6 +1,6 @@
 name = "SuiteSparse_jll"
 uuid = "bea87d4a-7f5b-5778-9afe-8cc45184846c"
-version = "7.2.1+1"
+version = "7.4.0+2"
 
 [deps]
 libblastrampoline_jll = "8e850b90-86db-534c-a0d3-1478176c7d93"
@@ -8,7 +8,7 @@ Libdl = "8f399da3-3557-5675-b5ff-fb832c97cbdb"
 Artifacts = "56f22d72-fd6d-98f1-02f0-08ddc0907c33"
 
 [compat]
-julia = "1.10"
+julia = "1.11"
 
 [extras]
 Test = "8dfed614-e22c-5e08-85e1-65c5234f0b40"
diff --git a/stdlib/SuiteSparse_jll/src/SuiteSparse_jll.jl b/stdlib/SuiteSparse_jll/src/SuiteSparse_jll.jl
index f245759aaf383..08614880a934c 100644
--- a/stdlib/SuiteSparse_jll/src/SuiteSparse_jll.jl
+++ b/stdlib/SuiteSparse_jll/src/SuiteSparse_jll.jl
@@ -58,7 +58,7 @@ elseif Sys.isapple()
     const libbtf = "@rpath/libbtf.2.dylib"
     const libcamd = "@rpath/libcamd.3.dylib"
     const libccolamd = "@rpath/libccolamd.3.dylib"
-    const libcholmod = "@rpath/libcholmod.4.dylib"
+    const libcholmod = "@rpath/libcholmod.5.dylib"
     const libcolamd = "@rpath/libcolamd.3.dylib"
     const libklu = "@rpath/libklu.2.dylib"
     const libldl = "@rpath/libldl.3.dylib"
@@ -71,7 +71,7 @@ else
     const libbtf = "libbtf.so.2"
     const libcamd = "libcamd.so.3"
     const libccolamd = "libccolamd.so.3"
-    const libcholmod = "libcholmod.so.4"
+    const libcholmod = "libcholmod.so.5"
     const libcolamd = "libcolamd.so.3"
     const libklu = "libklu.so.2"
     const libldl = "libldl.so.3"

From 40096dc6f79a47db58e5f36df89fd487b1c293b5 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Mos=C3=A8=20Giordano?= <mose@gnu.org>
Date: Tue, 2 Jan 2024 21:45:41 +0100
Subject: [PATCH 2/3] Update wrappers in `SparseArrays.jl`

Update information in `stdlib/SparseArrays.version` and then run the commands

```
git rm -rf deps/checksums/SparseArrays-*
make -C stdlib -j checksum-SparseArrays
```
---
 .../md5                                                         | 1 +
 .../sha512                                                      | 1 +
 .../md5                                                         | 1 -
 .../sha512                                                      | 1 -
 stdlib/SparseArrays.version                                     | 2 +-
 5 files changed, 3 insertions(+), 3 deletions(-)
 create mode 100644 deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/md5
 create mode 100644 deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/sha512
 delete mode 100644 deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/md5
 delete mode 100644 deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/sha512

diff --git a/deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/md5 b/deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/md5
new file mode 100644
index 0000000000000..7ef02b53c633b
--- /dev/null
+++ b/deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/md5
@@ -0,0 +1 @@
+bfb7951c370c7cb5dac9139d2b5720ea
diff --git a/deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/sha512 b/deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/sha512
new file mode 100644
index 0000000000000..d458020f2b49b
--- /dev/null
+++ b/deps/checksums/SparseArrays-f890a1e13fc04c295cec48a9b08b76c6e1a7039a.tar.gz/sha512
@@ -0,0 +1 @@
+1228277f51d48f6405ff9f31de6732bce020c2c06b2c768f88e6ff1226a6122fa9f63877228112d8067e0373d370ee26a7404d11948c28c06d4ee951d35407ff
diff --git a/deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/md5 b/deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/md5
deleted file mode 100644
index c0aec7507b021..0000000000000
--- a/deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/md5
+++ /dev/null
@@ -1 +0,0 @@
-939db38382d3e3796f3d83c4a965ab4c
diff --git a/deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/sha512 b/deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/sha512
deleted file mode 100644
index 8e9e0f6158041..0000000000000
--- a/deps/checksums/SparseArrays-feb54ee5e49008bd157227099cafe604a67c36fb.tar.gz/sha512
+++ /dev/null
@@ -1 +0,0 @@
-0c20dd814068df0fafaaba05029997b6420812ac3498df7484b8f77ccbcbbc3447e4b4ce6acbed7ab0b8293275d9c3f944bfa7ce5a8069a985b28d002a038005
diff --git a/stdlib/SparseArrays.version b/stdlib/SparseArrays.version
index 84ffe8b7c5296..00a3f26249c2e 100644
--- a/stdlib/SparseArrays.version
+++ b/stdlib/SparseArrays.version
@@ -1,4 +1,4 @@
 SPARSEARRAYS_BRANCH = main
-SPARSEARRAYS_SHA1 = feb54ee5e49008bd157227099cafe604a67c36fb
+SPARSEARRAYS_SHA1 = f890a1e13fc04c295cec48a9b08b76c6e1a7039a
 SPARSEARRAYS_GIT_URL := https://github.com/JuliaSparse/SparseArrays.jl.git
 SPARSEARRAYS_TAR_URL = https://api.github.com/repos/JuliaSparse/SparseArrays.jl/tarball/$1

From 2b9634ab073a3727035a9e86694d30fe93072ac0 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Mos=C3=A8=20Giordano?= <mose@gnu.org>
Date: Fri, 5 Jan 2024 19:14:53 +0100
Subject: [PATCH 3/3] Update SuiteSparse build recipe for when
 `USE_BINARYBUILDER_LIBSUITESPARSE=0`

---
 deps/libsuitesparse.mk                     | 50 ++++++++++++----------
 deps/patches/suitesparse-blas-suffix.patch | 40 +++++++++++++++++
 2 files changed, 68 insertions(+), 22 deletions(-)
 create mode 100644 deps/patches/suitesparse-blas-suffix.patch

diff --git a/deps/libsuitesparse.mk b/deps/libsuitesparse.mk
index fa1eda94b5c4f..386194221b43c 100644
--- a/deps/libsuitesparse.mk
+++ b/deps/libsuitesparse.mk
@@ -3,26 +3,28 @@ include $(SRCDIR)/libsuitesparse.version
 
 ifneq ($(USE_BINARYBUILDER_LIBSUITESPARSE), 1)
 
-LIBSUITESPARSE_PROJECTS := AMD BTF CAMD CCOLAMD COLAMD CHOLMOD LDL KLU UMFPACK RBio SPQR
-LIBSUITESPARSE_LIBS := $(addsuffix .*$(SHLIB_EXT)*,suitesparseconfig amd btf camd ccolamd colamd cholmod klu ldl umfpack rbio spqr)
+LIBSUITESPARSE_PROJECTS := "amd;btf;camd;ccolamd;colamd;cholmod;klu;ldl;umfpack;rbio;spqr"
+LIBSUITESPARSE_LIBS := $(addsuffix .*$(SHLIB_EXT)*,suitesparseconfig $(subst ;, ,$(LIBSUITESPARSE_PROJECTS)))
 
 LIBSUITESPARSE_CMAKE_FLAGS := $(CMAKE_COMMON) \
 	  -DCMAKE_BUILD_TYPE=Release \
-	  -DENABLE_CUDA=0 \
-	  -DNFORTRAN=1 \
-	  -DNOPENMP=1 \
-	  -DNPARTITION=0 \
-	  -DNSTATIC=1 \
+	  -DBUILD_STATIC_LIBS=OFF \
+	  -DBUILD_TESTING=OFF \
+	  -DSUITESPARSE_ENABLE_PROJECTS="suitesparse_config;$(LIBSUITESPARSE_PROJECTS)" \
+	  -DSUITESPARSE_DEMOS=OFF \
+	  -DSUITESPARSE_USE_STRICT=ON \
+	  -DSUITESPARSE_USE_CUDA=OFF \
+	  -DSUITESPARSE_USE_FORTRAN=OFF \
+	  -DSUITESPARSE_USE_OPENMP=OFF \
+	  -DCHOLMOD_PARTITION=ON \
 	  -DBLAS_FOUND=1 \
 	  -DBLAS_LIBRARIES="$(build_shlibdir)/libblastrampoline.$(SHLIB_EXT)" \
 	  -DBLAS_LINKER_FLAGS="blastrampoline" \
-	  -DBLAS_UNDERSCORE=ON \
 	  -DBLA_VENDOR="blastrampoline" \
-	  -DBLAS64_SUFFIX="_64" \
-	  -DALLOW_64BIT_BLAS=ON \
-	  -DLAPACK_FOUND=1 \
 	  -DLAPACK_LIBRARIES="$(build_shlibdir)/libblastrampoline.$(SHLIB_EXT)" \
-	  -DLAPACK_LINKER_FLAGS="blastrampoline"
+	  -DLAPACK_LINKER_FLAGS="blastrampoline" \
+	  -DBLAS64_SUFFIX="_64" \
+	  -DSUITESPARSE_USE_64BIT_BLAS=YES
 
 ifneq (,$(findstring $(OS),Linux FreeBSD))
 LIBSUITESPARSE_CMAKE_FLAGS += -DCMAKE_INSTALL_RPATH="\$$ORIGIN"
@@ -40,17 +42,21 @@ $(BUILDDIR)/SuiteSparse-$(LIBSUITESPARSE_VER)/source-extracted: $(SRCCACHE)/Suit
 checksum-libsuitesparse: $(SRCCACHE)/SuiteSparse-$(LIBSUITESPARSE_VER).tar.gz
 	$(JLCHECKSUM) $<
 
+# https://github.com/DrTimothyAldenDavis/SuiteSparse/pull/671
+$(SRCCACHE)/SuiteSparse-$(LIBSUITESPARSE_VER)/suitesparse-blas-suffix.patch-applied: $(SRCCACHE)/SuiteSparse-$(LIBSUITESPARSE_VER)/source-extracted
+	cd $(dir $@) && \
+		patch -p1 -f < $(SRCDIR)/patches/suitesparse-blas-suffix.patch
+	echo 1 > $@
+
+$(SRCCACHE)/SuiteSparse-$(LIBSUITESPARSE_VER)/source-patched: $(SRCCACHE)/SuiteSparse-$(LIBSUITESPARSE_VER)/suitesparse-blas-suffix.patch-applied
+	echo 1 > $@
+
 $(BUILDDIR)/SuiteSparse-$(LIBSUITESPARSE_VER)/build-compiled: | $(build_prefix)/manifest/blastrampoline
 
-$(BUILDDIR)/SuiteSparse-$(LIBSUITESPARSE_VER)/build-compiled: $(BUILDDIR)/SuiteSparse-$(LIBSUITESPARSE_VER)/source-extracted
-	cd $(dir $<); \
-	for PROJ in SuiteSparse_config $(LIBSUITESPARSE_PROJECTS); do \
-		cd $${PROJ}/build || exit 1; \
-		$(CMAKE) .. $(LIBSUITESPARSE_CMAKE_FLAGS) || exit 1; \
-		make || exit 1; \
-		make install || exit 1; \
-		cd ../..; \
-	done
+$(BUILDDIR)/SuiteSparse-$(LIBSUITESPARSE_VER)/build-compiled: $(SRCCACHE)/SuiteSparse-$(LIBSUITESPARSE_VER)/source-patched
+	cd $(dir $<) && $(CMAKE) .. $(LIBSUITESPARSE_CMAKE_FLAGS)
+	make
+	make install
 	echo 1 > $@
 
 ifeq ($(OS),WINNT)
@@ -59,7 +65,7 @@ else
 LIBSUITESPARSE_SHLIB_ENV:=LD_LIBRARY_PATH="$(build_shlibdir)"
 endif
 $(BUILDDIR)/SuiteSparse-$(LIBSUITESPARSE_VER)/build-checked: $(BUILDDIR)/SuiteSparse-$(LIBSUITESPARSE_VER)/build-compiled
-	for PROJ in $(LIBSUITESPARSE_PROJECTS); do \
+	for PROJ in $(shell echo $(subst ;, ,$(LIBSUITESPARSE_PROJECTS))); do \
 		$(LIBSUITESPARSE_SHLIB_ENV) $(MAKE) -C $(dir $<)$${PROJ} default $(LIBSUITESPARSE_MFLAGS) || exit 1; \
 	done
 	echo 1 > $@
diff --git a/deps/patches/suitesparse-blas-suffix.patch b/deps/patches/suitesparse-blas-suffix.patch
new file mode 100644
index 0000000000000..c6a04ddee618d
--- /dev/null
+++ b/deps/patches/suitesparse-blas-suffix.patch
@@ -0,0 +1,40 @@
+From b936940aab08dc4bc60ccf2b9daec2105a960ad4 Mon Sep 17 00:00:00 2001
+From: =?UTF-8?q?Markus=20M=C3=BCtzel?= <markus.muetzel@gmx.de>
+Date: Mon, 1 Jan 2024 13:00:17 +0100
+Subject: [PATCH] Add preprocessor definitions also with user-supplied
+ BLAS_LIBRARIES
+
+---
+ SuiteSparse_config/cmake_modules/SuiteSparseBLAS.cmake   | 4 ++--
+ SuiteSparse_config/cmake_modules/SuiteSparseBLAS64.cmake | 2 +-
+ 2 files changed, 3 insertions(+), 3 deletions(-)
+
+diff --git a/SuiteSparse_config/cmake_modules/SuiteSparseBLAS.cmake b/SuiteSparse_config/cmake_modules/SuiteSparseBLAS.cmake
+index ca241472d..be7cd2e73 100644
+--- a/SuiteSparse_config/cmake_modules/SuiteSparseBLAS.cmake
++++ b/SuiteSparse_config/cmake_modules/SuiteSparseBLAS.cmake
+@@ -36,9 +36,9 @@ if ( DEFINED BLAS_LIBRARIES OR DEFINED BLAS_INCLUDE_DIRS )
+     # User supplied variables for libraries and/or include directories.
+     # Use them as-is.
+     if ( SUITESPARSE_USE_64BIT_BLAS )
+-        set ( SuiteSparse_BLAS_integer "int64_t" )
++        include ( SuiteSparseBLAS64 )
+     else ( )
+-        set ( SuiteSparse_BLAS_integer "int32_t" )
++        include ( SuiteSparseBLAS32 )
+     endif ( )
+     return ( )
+ endif ( )
+diff --git a/SuiteSparse_config/cmake_modules/SuiteSparseBLAS64.cmake b/SuiteSparse_config/cmake_modules/SuiteSparseBLAS64.cmake
+index 744aaef91..1a5c63690 100644
+--- a/SuiteSparse_config/cmake_modules/SuiteSparseBLAS64.cmake
++++ b/SuiteSparse_config/cmake_modules/SuiteSparseBLAS64.cmake
+@@ -37,7 +37,7 @@ set ( SuiteSparse_BLAS_integer "int64_t" )
+ # https://github.com/spack/spack/blob/develop/var/spack/repos/builtin/packages/suite-sparse/package.py
+
+ if ( DEFINED BLAS64_SUFFIX )
+-    # append BLAS64_SUFFIX to each BLAS and LAPACK name
++    # append BLAS64_SUFFIX to each BLAS and LAPACK function name
+     string ( FIND ${BLAS64_SUFFIX} "_" HAS_UNDERSCORE )
+     message ( STATUS "BLAS64_suffix: ${BLAS64_SUFFIX}" )
+     if ( HAS_UNDERSCORE EQUAL -1 )
